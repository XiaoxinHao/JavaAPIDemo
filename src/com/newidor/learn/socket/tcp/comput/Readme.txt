代码来源：
1、http://www.cnblogs.com/linzheng/archive/2011/01/23/1942328.html
并M行了部分改造